"use strict";var dayInput=document.querySelector("#day"),monthInput=document.querySelector("#month"),yearInput=document.querySelector("#year"),subBtn=document.querySelector(".submit"),inputs=document.querySelectorAll("input"),daysSpan=document.querySelector("#days"),monthsSpan=document.querySelector("#months"),yearsSpan=document.querySelector("#years"),dateDiff=function(t,e){function n(t,e){return new Date(t,e+1,0).getDate()}var r=e.getFullYear()-t.getFullYear(),a=e.getMonth()-t.getMonth(),t=e.getDate()-t.getDate(),r=12*r+a,a=t;return t<0&&(r--,t=(e.getMonth()-1+12)%12,a+=n(e.getFullYear()-(11==t?1:0),t)),a===n(e.getFullYear(),e.getMonth()-1)&&(a=0,r++),{years:Math.floor(r/12),months:r%=12,days:a}},getCurrentAndInputDate=function(t,e,n){return{currentDate:new Date,inputDate:new Date(parseInt(n.value,10),parseInt(e.value,10)-1,parseInt(t.value,10))}},countDate=function(){var t=validateInput(dayInput,dayInput,monthInput,yearInput),e=validateInput(monthInput,dayInput,monthInput,yearInput),n=validateInput(yearInput,dayInput,monthInput,yearInput);t&&e&&n&&(e=(t=getCurrentAndInputDate(dayInput,monthInput,yearInput)).currentDate,n=t.inputDate,t=dateDiff(n,e),daysSpan.textContent=t.days,monthsSpan.textContent=t.months,yearsSpan.textContent=t.years)},validateInput=function(t,e,n,r){var a=t.nextElementSibling,u=t.previousElementSibling,o=parseInt(t.getAttribute("min"),10),s=parseInt(t.getAttribute("max"),10),l=getCurrentAndInputDate(e,n,r),d=l.currentDate,l=l.inputDate;return clearErrors(u,t,a),""===t.value?(addErrors(u,t),!(a.textContent="This field is required")):"year"===t.id&&(parseInt(t.value,10)>d.getFullYear()||parseInt(t.value,10)===d.getFullYear()&&(parseInt(n.value,10)>d.getMonth()+1||parseInt(n.value,10)===d.getMonth()+1&&parseInt(e.value,10)>d.getDate()))?(addErrors(u,t),!(a.textContent="Must be in the past")):null!==o&&parseInt(t.value,10)<o||null!==s&&parseInt(t.value,10)>s?(addErrors(u,t),a.textContent="Must be a valid ".concat(t.id),!1):l.getFullYear()!==parseInt(r.value,10)||l.getMonth()!==parseInt(n.value,10)-1||l.getDate()!==parseInt(e.value,10)?(addErrorToAllInputs([e,n,r],"Must be a valid date"),!1):(clearErrors(u,t,a),!0)},clearErrors=function(t,e,n){t.classList.remove("error"),e.classList.remove("error"),n.textContent=""},addErrors=function(t,e){t.classList.add("error"),e.classList.add("error")},addErrorToAllInputs=function(t,r){t.forEach(function(t){var e=t.previousElementSibling,n=t.nextElementSibling;e.classList.add("error"),t.classList.add("error"),"day"===t.id&&(n.textContent=r)})},enterCheck=function(t){"Enter"===t.key&&countDate()};subBtn.addEventListener("click",countDate),inputs.forEach(function(t){return t.addEventListener("keyup",enterCheck)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZGF5SW5wdXQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtb250aElucHV0IiwieWVhcklucHV0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0cyIsImRheXNTcGFuIiwibW9udGhzU3BhbiIsImRhdGVEaWZmIiwiZGF0ZTEiLCJkYXRlMiIsImRheXNJbk1vbnRoIiwieWVhciIsIkRhdGUiLCJtb250aCIsImdldERhdGUiLCJnZXRGdWxsWWVhciIsInllYXJzIiwibW9udGhzIiwiZ2V0TW9udGgiLCJhZGp1c3RlZE1vbnRocyIsImRheXMiLCJwcmV2TW9udGgiLCJhZGp1c3RlZERheXMiLCJNYXRoIiwiZmxvb3IiLCJhZGp1c3RlZFllYXJzIiwiY3VycmVudERhdGUiLCJpbnB1dERhdGUiLCJwYXJzZUludCIsInZhbHVlIiwiaXNNb250aFZhbGlkIiwiaXNZZWFyVmFsaWQiLCJ2YWxpZGF0ZUlucHV0IiwiaXNEYXlWYWxpZCIsImdldEN1cnJlbnRBbmRJbnB1dERhdGUiLCJfZ2V0Q3VycmVudEFuZElucHV0RGEiLCJ0ZXh0Q29udGVudCIsImRpZmYiLCJ5ZWFyc1NwYW4iLCJlcnJvckVsZW1lbnQiLCJpbnB1dCIsIm5leHRFbGVtZW50U2libGluZyIsIm1heFZhbHVlIiwiZ2V0QXR0cmlidXRlIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNsZWFyRXJyb3JzIiwibGFiZWxFbGVtZW50IiwiX2dldEN1cnJlbnRBbmRJbnB1dERhMiIsImFkZEVycm9ycyIsImFkZEVycm9yVG9BbGxJbnB1dHMiLCJtaW5WYWx1ZSIsImxhYmVsIiwiY2xhc3NMaXN0IiwiZXJyb3JNc2ciLCJjb25jYXQiLCJpZCIsImVudGVyQ2hlY2siLCJyZW1vdmUiLCJjb3VudERhdGUiLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkIiwiZm9yRWFjaCIsImUiLCJrZXkiLCJzdWJCdG4iXSwibWFwcGluZ3MiOiJhQUFBLElBQU1BLFNBQVdDLFNB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QnRFLEVBRU1YLG9CQUFzQixTQUFDN0MsRUFBUWlELEdBQ3BDakQsRUFBT3lELFFBQVEsU0FBQ3JCLEdBQ2YsSUFBTU0sRUFBZU4sRUFBTUksdUJBQ3JCTCxFQUFlQyxFQUFNQyxtQkFDM0JLLEVBQWFNLFVBQVVRLElBQUksT0FBTyxFQUNsQ3BCLEVBQU1ZLFVBQVVRLElBQUksT0FBTyxFQUNWLFFBQWJwQixFQUFNZSxLQUNUaEIsRUFBYUgsWUFBY2lCLEVBRTdCLENBQUMsQ0FDRixFQUVNRyxXQUFhLFNBQUNNLEdBQ0wsVUFBVkEsRUFBRUMsS0FDTEwsVUFBUyxDQUVYLEVBRUFNLE9BQU9MLGlCQUFpQixRQUFTRCxTQUFTLEVBQzFDdEQsT0FBT3lELFFBQVEsU0FBQ3JCLEdBQUssT0FBS0EsRUFBTW1CLGlCQUFpQixRQUFTSCxVQUFVLENBQUMsQ0FBQSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGRheUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RheScpXHJcbmNvbnN0IG1vbnRoSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbW9udGgnKVxyXG5jb25zdCB5ZWFySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjeWVhcicpXHJcbmNvbnN0IHN1YkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQnKVxyXG5jb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpXHJcblxyXG5jb25zdCBkYXlzU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXlzJylcclxuY29uc3QgbW9udGhzU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtb250aHMnKVxyXG5jb25zdCB5ZWFyc1NwYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjeWVhcnMnKVxyXG5cclxuLy9vdXIgbW9udGhzIGNhbiBoYXZlIDMwLzMxLzI5LzI4IGRheXNcclxuY29uc3QgZGF0ZURpZmYgPSAoZGF0ZTEsIGRhdGUyKSA9PiB7XHJcbiAgICBjb25zdCB5ZWFycyA9IGRhdGUyLmdldEZ1bGxZZWFyKCkgLSBkYXRlMS5nZXRGdWxsWWVhcigpO1xyXG4gICAgY29uc3QgbW9udGhzID0gZGF0ZTIuZ2V0TW9udGgoKSAtIGRhdGUxLmdldE1vbnRoKCk7XHJcbiAgICBjb25zdCBkYXlzID0gZGF0ZTIuZ2V0RGF0ZSgpIC0gZGF0ZTEuZ2V0RGF0ZSgpO1xyXG5cclxuICAgIGNvbnN0IGRheXNJbk1vbnRoID0gKHllYXIsIG1vbnRoKSA9PiBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIDApLmdldERhdGUoKTtcclxuXHJcbiAgICBsZXQgYWRqdXN0ZWRNb250aHMgPSB5ZWFycyAqIDEyICsgbW9udGhzO1xyXG4gICAgbGV0IGFkanVzdGVkRGF5cyA9IGRheXM7XHJcblxyXG4gICAgaWYgKGRheXMgPCAwKSB7XHJcbiAgICAgICAgYWRqdXN0ZWRNb250aHMtLTtcclxuICAgICAgICBjb25zdCBwcmV2TW9udGggPSAoZGF0ZTIuZ2V0TW9udGgoKSAtIDEgKyAxMikgJSAxMjtcclxuICAgICAgICBjb25zdCBwcmV2TW9udGhZZWFyID0gZGF0ZTIuZ2V0RnVsbFllYXIoKSAtIChwcmV2TW9udGggPT09IDExID8gMSA6IDApO1xyXG4gICAgICAgIGFkanVzdGVkRGF5cyArPSBkYXlzSW5Nb250aChwcmV2TW9udGhZZWFyLCBwcmV2TW9udGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhZGp1c3RlZERheXMgPT09IGRheXNJbk1vbnRoKGRhdGUyLmdldEZ1bGxZZWFyKCksIGRhdGUyLmdldE1vbnRoKCkgLSAxKSkge1xyXG4gICAgICAgIGFkanVzdGVkRGF5cyA9IDA7XHJcbiAgICAgICAgYWRqdXN0ZWRNb250aHMrKztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhZGp1c3RlZFllYXJzID0gTWF0aC5mbG9vcihhZGp1c3RlZE1vbnRocyAvIDEyKTtcclxuICAgIGFkanVzdGVkTW9udGhzICU9IDEyO1xyXG5cclxuICAgIHJldHVybiB7IHllYXJzOiBhZGp1c3RlZFllYXJzLCBtb250aHM6IGFkanVzdGVkTW9udGhzLCBkYXlzOiBhZGp1c3RlZERheXMgfTtcclxufTtcclxuXHJcblxyXG5jb25zdCBnZXRDdXJyZW50QW5kSW5wdXREYXRlID0gKGRheUlucHV0LCBtb250aElucHV0LCB5ZWFySW5wdXQpID0+IHtcclxuXHRjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XHJcblx0Y29uc3QgaW5wdXREYXRlID0gbmV3IERhdGUoXHJcblx0XHRwYXJzZUludCh5ZWFySW5wdXQudmFsdWUsIDEwKSxcclxuXHRcdC8vbW9udGhzIGFyZSBpbmRleGVkIGZyb20gMCB0byAxMVxyXG5cdFx0cGFyc2VJbnQobW9udGhJbnB1dC52YWx1ZSwgMTApIC0gMSxcclxuXHRcdHBhcnNlSW50KGRheUlucHV0LnZhbHVlLCAxMClcclxuXHQgICk7XHJcblx0ICByZXR1cm4geyBjdXJyZW50RGF0ZSwgaW5wdXREYXRlIH07XHJcbn1cclxuXHJcbmNvbnN0IGNvdW50RGF0ZSA9ICgpID0+IHtcclxuXHRjb25zdCBpc0RheVZhbGlkID0gdmFsaWRhdGVJbnB1dChkYXlJbnB1dCwgZGF5SW5wdXQsIG1vbnRoSW5wdXQsIHllYXJJbnB1dClcclxuXHRjb25zdCBpc01vbnRoVmFsaWQgPSB2YWxpZGF0ZUlucHV0KG1vbnRoSW5wdXQsIGRheUlucHV0LCBtb250aElucHV0LCB5ZWFySW5wdXQpXHJcblx0Y29uc3QgaXNZZWFyVmFsaWQgPSB2YWxpZGF0ZUlucHV0KHllYXJJbnB1dCwgZGF5SW5wdXQsIG1vbnRoSW5wdXQsIHllYXJJbnB1dClcclxuXHJcblx0aWYgKCFpc0RheVZhbGlkIHx8ICFpc01vbnRoVmFsaWQgfHwgIWlzWWVhclZhbGlkKSB7XHJcblx0XHRyZXR1cm5cclxuXHR9XHJcblxyXG5cdGNvbnN0IHsgY3VycmVudERhdGUsIGlucHV0RGF0ZSB9ID0gZ2V0Q3VycmVudEFuZElucHV0RGF0ZShkYXlJbnB1dCwgbW9udGhJbnB1dCwgeWVhcklucHV0KTtcclxuXHRjb25zdCBkaWZmID0gZGF0ZURpZmYoaW5wdXREYXRlLCBjdXJyZW50RGF0ZSlcclxuXHJcblx0ZGF5c1NwYW4udGV4dENvbnRlbnQgPSBkaWZmLmRheXNcclxuXHRtb250aHNTcGFuLnRleHRDb250ZW50ID0gZGlmZi5tb250aHNcclxuXHR5ZWFyc1NwYW4udGV4dENvbnRlbnQgPSBkaWZmLnllYXJzXHJcbn1cclxuXHJcbmNvbnN0IHZhbGlkYXRlSW5wdXQgPSAoaW5wdXQsIGRheUlucHV0LCBtb250aElucHV0LCB5ZWFySW5wdXQpID0+IHtcclxuXHRjb25zdCBlcnJvckVsZW1lbnQgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmdcclxuXHRjb25zdCBsYWJlbEVsZW1lbnQgPSBpbnB1dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nXHJcblx0Y29uc3QgbWluVmFsdWUgPSBwYXJzZUludChpbnB1dC5nZXRBdHRyaWJ1dGUoJ21pbicpLCAxMClcclxuXHRjb25zdCBtYXhWYWx1ZSA9IHBhcnNlSW50KGlucHV0LmdldEF0dHJpYnV0ZSgnbWF4JyksIDEwKVxyXG5cdGNvbnN0IHsgY3VycmVudERhdGUsIGlucHV0RGF0ZSB9ID0gZ2V0Q3VycmVudEFuZElucHV0RGF0ZShkYXlJbnB1dCwgbW9udGhJbnB1dCwgeWVhcklucHV0KTtcclxuXHJcblx0Y2xlYXJFcnJvcnMobGFiZWxFbGVtZW50LCBpbnB1dCwgZXJyb3JFbGVtZW50KVxyXG5cclxuXHRpZiAoaW5wdXQudmFsdWUgPT09ICcnKSB7XHJcblx0XHRhZGRFcnJvcnMobGFiZWxFbGVtZW50LCBpbnB1dClcclxuXHRcdGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGBUaGlzIGZpZWxkIGlzIHJlcXVpcmVkYFxyXG5cdFx0cmV0dXJuIGZhbHNlXHJcblx0fSBlbHNlIGlmIChcclxuXHRcdGlucHV0LmlkID09PSAneWVhcicgJiZcclxuXHRcdChwYXJzZUludChpbnB1dC52YWx1ZSwgMTApID4gY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSB8fFxyXG5cdFx0XHQocGFyc2VJbnQoaW5wdXQudmFsdWUsIDEwKSA9PT0gY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSAmJlxyXG5cdFx0XHRcdChwYXJzZUludChtb250aElucHV0LnZhbHVlLCAxMCkgPiBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSB8fFxyXG5cdFx0XHRcdFx0KHBhcnNlSW50KG1vbnRoSW5wdXQudmFsdWUsIDEwKSA9PT0gY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEgJiZcclxuXHRcdFx0XHRcdFx0cGFyc2VJbnQoZGF5SW5wdXQudmFsdWUsIDEwKSA+IGN1cnJlbnREYXRlLmdldERhdGUoKSkpKSlcclxuXHQpIHtcclxuXHRcdGFkZEVycm9ycyhsYWJlbEVsZW1lbnQsIGlucHV0KVxyXG5cdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gYE11c3QgYmUgaW4gdGhlIHBhc3RgXHJcblx0XHRyZXR1cm4gZmFsc2VcclxuXHR9IGVsc2UgaWYgKFxyXG5cdFx0KG1pblZhbHVlICE9PSBudWxsICYmIHBhcnNlSW50KGlucHV0LnZhbHVlLCAxMCkgPCBtaW5WYWx1ZSkgfHxcclxuXHRcdChtYXhWYWx1ZSAhPT0gbnVsbCAmJiBwYXJzZUludChpbnB1dC52YWx1ZSwgMTApID4gbWF4VmFsdWUpXHJcblx0KSB7XHJcblx0XHRhZGRFcnJvcnMobGFiZWxFbGVtZW50LCBpbnB1dClcclxuXHRcdGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGBNdXN0IGJlIGEgdmFsaWQgJHtpbnB1dC5pZH1gXHJcblx0XHRyZXR1cm4gZmFsc2VcclxuXHR9IGVsc2UgaWYgKFxyXG5cdFx0aW5wdXREYXRlLmdldEZ1bGxZZWFyKCkgIT09IHBhcnNlSW50KHllYXJJbnB1dC52YWx1ZSwgMTApIHx8XHJcblx0XHRpbnB1dERhdGUuZ2V0TW9udGgoKSAhPT0gcGFyc2VJbnQobW9udGhJbnB1dC52YWx1ZSwgMTApIC0gMSB8fFxyXG5cdFx0aW5wdXREYXRlLmdldERhdGUoKSAhPT0gcGFyc2VJbnQoZGF5SW5wdXQudmFsdWUsIDEwKVxyXG5cdCkge1xyXG5cdFx0YWRkRXJyb3JUb0FsbElucHV0cyhbZGF5SW5wdXQsIG1vbnRoSW5wdXQsIHllYXJJbnB1dF0sIGBNdXN0IGJlIGEgdmFsaWQgZGF0ZWApXHJcblx0XHRyZXR1cm4gZmFsc2VcclxuXHR9IGVsc2Uge1xyXG5cdFx0Y2xlYXJFcnJvcnMobGFiZWxFbGVtZW50LCBpbnB1dCwgZXJyb3JFbGVtZW50KVxyXG5cdFx0cmV0dXJuIHRydWVcclxuXHR9XHJcbn1cclxuXHJcblxyXG5jb25zdCBjbGVhckVycm9ycyA9IChsYWJlbCwgaW5wdXQsIGVycm9yTXNnKSA9PiB7XHJcblx0bGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKVxyXG5cdGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJylcclxuXHRlcnJvck1zZy50ZXh0Q29udGVudCA9ICcnXHJcbn1cclxuXHJcbmNvbnN0IGFkZEVycm9ycyA9IChsYWJlbCwgaW5wdXQpID0+IHtcclxuXHRsYWJlbC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpXHJcblx0aW5wdXQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKVxyXG59XHJcblxyXG5jb25zdCBhZGRFcnJvclRvQWxsSW5wdXRzID0gKGlucHV0cywgZXJyb3JNc2cpID0+IHtcclxuXHRpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuXHRcdGNvbnN0IGxhYmVsRWxlbWVudCA9IGlucHV0LnByZXZpb3VzRWxlbWVudFNpYmxpbmdcclxuXHRcdGNvbnN0IGVycm9yRWxlbWVudCA9IGlucHV0Lm5leHRFbGVtZW50U2libGluZ1xyXG5cdFx0bGFiZWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJylcclxuXHRcdGlucHV0LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJylcclxuXHRcdGlmIChpbnB1dC5pZCA9PT0gJ2RheScpIHtcclxuXHRcdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNc2dcclxuXHRcdH1cclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCBlbnRlckNoZWNrID0gKGUpID0+IHtcclxuXHRpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcclxuXHRcdGNvdW50RGF0ZSgpXHJcblx0fVxyXG59XHJcblxyXG5zdWJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjb3VudERhdGUpXHJcbmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4gaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBlbnRlckNoZWNrKSlcclxuIl19
